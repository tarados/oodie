<template>
  <div class="wrapper">
    <div class="grid-container first">
      <div class="item logo">
        <svg xmlns="http://www.w3.org/2000/svg" version="1.0" width="115px" style="margin:0 5px"
             viewBox="0 0 3465.000000 1424.000000" preserveAspectRatio="xMidYMid meet">
          <devs>
            <g id="logosvg" transform="translate(0.000000,1424.000000) scale(0.100000,-0.100000)"
               fill="#82a9d3"
               stroke="none">
              <path
                  d="M2745 13956 c-76 -34 -94 -87 -95 -282 0 -158 8 -202 44 -242 35 -39 73 -53 174 -63 117 -12 166 -36 196 -94 l21 -40 0 -1780 0 -1780 -22 -41 c-30 -56 -83 -81 -200 -93 -127 -13 -170 -39 -199 -118 -17 -48 -19 -300 -2 -355 14 -47 63 -93 115 -107 54 -15 1234 -15 1288 0 52 15 100 65 115 119 7 27 10 98 8 189 -3 125 -6 151 -24 181 -27 47 -75 78 -132 85 -141 18 -189 44 -217 118 -14 37 -15 112 -13 667 l3 625 27 50 c33 62 80 108 181 175 215 143 449 211 623 181 170 -30 276 -130 331 -312 14 -47 17 -140 20 -687 4 -554 2 -639 -12 -687 -22 -76 -58 -102 -172 -122 -110 -19 -147 -36 -175 -82 -21 -33 -23 -50 -26 -206 -3 -162 -2 -172 20 -214 16 -29 37 -52 63 -65 39 -21 54 -21 663 -24 414 -2 636 1 662 8 104 28 134 99 128 308 -2 112 -7 144 -23 177 -27 53 -73 82 -143 90 -171 18 -215 36 -250 98 -16 29 -18 96 -23 792 -5 657 -8 772 -23 850 -82 435 -354 690 -784 734 -212 22 -458 -40 -660 -166 -42 -26 -120 -80 -172 -119 -115 -86 -129 -94 -173 -94 -23 0 -41 8 -58 26 l-24 26 -5 1076 c-4 965 -7 1081 -21 1112 -20 42 -53 75 -92 89 -45 17 -903 14 -942 -3z"
                  fill="#151515"></path>
              <path
                  d="M1350 12771 c-270 -116 -337 -156 -369 -219 -28 -56 -32 -85 -40 -295 -10 -286 -19 -296 -270 -308 -163 -8 -200 -16 -240 -52 -39 -36 -53 -84 -58 -207 -6 -136 7 -238 37 -280 38 -53 70 -63 237 -71 165 -8 209 -17 241 -52 53 -56 52 -45 52 -769 1 -737 8 -931 39 -1052 97 -372 408 -586 850 -586 205 0 460 60 584 137 88 55 125 156 134 368 7 142 -4 177 -64 202 -35 14 -44 13 -167 -18 -118 -30 -145 -34 -276 -34 -144 0 -146 0 -212 33 -93 45 -141 108 -169 222 -11 44 -14 188 -14 730 l0 675 23 47 c18 36 34 52 70 70 45 22 60 23 362 28 295 5 317 6 350 26 78 45 94 106 89 321 -5 159 -19 195 -95 233 -48 25 -53 25 -364 30 -292 5 -317 6 -349 25 -82 48 -91 93 -91 470 0 255 -2 284 -20 323 -37 81 -90 81 -270 3z"
                  fill="#151515"></path>
              <path
                  d="M7435 12005 c-361 -51 -629 -185 -865 -432 -281 -293 -430 -691 -430 -1150 0 -438 147 -812 429 -1093 297 -296 707 -450 1194 -450 261 0 530 41 754 115 186 62 281 122 324 206 36 72 69 346 49 419 -26 98 -74 103 -268 26 -151 -60 -264 -95 -416 -128 -88 -20 -131 -22 -336 -23 -211 0 -244 3 -323 23 -232 58 -404 165 -512 317 -62 87 -96 161 -102 219 -5 46 -2 55 22 84 14 17 43 36 63 42 24 6 369 11 942 13 678 3 914 7 943 16 48 16 99 66 116 117 22 64 26 328 7 467 -93 666 -487 1090 -1115 1198 -154 26 -349 32 -476 14z m389 -595 c186 -47 336 -169 419 -340 103 -210 84 -330 -55 -359 -39 -8 -221 -11 -614 -9 -541 3 -560 4 -594 23 -19 12 -43 38 -54 59 -17 34 -18 46 -8 98 24 130 142 317 254 404 93 72 216 125 333 144 83 12 228 4 319 -20z"
                  fill="#151515"></path>
              <path
                  d="M21771 11370 c-39 -9 -77 -35 -105 -74 l-21 -27 -5 -2049 -5 -2049 -21 -28 c-24 -32 -57 -40 -90 -22 -13 7 -67 68 -119 135 -314 406 -699 658 -1200 784 -728 184 -1584 74 -2229 -286 -592 -330 -1114 -890 -1446 -1554 -214 -427 -333 -827 -407 -1365 -27 -194 -27 -214 -27 -655 0 -413 2 -471 22 -625 49 -372 110 -651 202 -928 320 -958 995 -1729 1820 -2078 80 -34 150 -65 155 -69 43 -32 383 -117 590 -149 448 -67 779 -61 1180 21 55 11 118 24 140 29 69 14 243 68 282 88 21 10 83 38 137 62 196 84 404 227 561 384 96 96 155 169 255 318 79 118 113 147 150 127 42 -23 44 -41 50 -385 4 -288 7 -334 22 -362 27 -49 70 -74 147 -84 41 -6 421 -9 928 -7 l859 3 48 25 c35 18 55 37 70 65 l21 40 3 5265 c2 3878 0 5279 -8 5318 -6 29 -23 66 -36 82 -52 61 -37 60 -1008 59 -485 -1 -896 -5 -915 -9z m-1425 -5064 c259 -55 501 -165 689 -315 63 -50 221 -209 280 -281 310 -380 477 -905 477 -1500 1 -707 -218 -1273 -649 -1680 -205 -194 -422 -314 -698 -385 -182 -47 -303 -59 -525 -52 -201 6 -306 24 -479 79 -580 185 -1033 720 -1185 1398 -54 241 -61 314 -60 625 0 227 4 315 17 405 59 377 173 691 345 950 297 446 690 706 1172 776 153 22 464 12 616 -20z"></path>
              <path
                  d="M25250 11135 c-274 -45 -495 -155 -695 -347 -261 -249 -382 -559 -347 -885 22 -201 85 -365 200 -519 237 -319 619 -504 1042 -504 627 0 1120 378 1226 939 24 128 15 354 -20 476 -118 417 -488 738 -956 830 -116 23 -342 28 -450 10z"></path>
              <path
                  d="M3755 8110 c-835 -81 -1491 -336 -2084 -809 -705 -563 -1163 -1324 -1335 -2216 -60 -315 -70 -437 -70 -870 0 -358 2 -418 22 -570 86 -643 267 -1154 579 -1634 148 -228 286 -395 502 -611 297 -296 606 -519 966 -695 345 -170 644 -271 1000 -339 116 -22 162 -29 335 -52 25 -3 56 -7 70 -9 92 -13 238 -20 450 -20 277 0 377 7 570 41 14 2 70 11 125 19 55 9 136 23 180 31 89 17 453 118 500 139 17 8 84 35 150 60 507 196 1010 544 1388 963 525 580 823 1231 937 2042 44 311 44 954 0 1270 -86 619 -283 1146 -611 1630 -311 460 -765 878 -1254 1155 -385 219 -855 377 -1315 444 -338 49 -784 62 -1105 31z m645 -1780 c419 -51 765 -218 1062 -513 179 -179 297 -344 409 -572 111 -227 180 -470 210 -735 14 -133 15 -473 0 -609 -47 -436 -210 -833 -473 -1146 -284 -339 -636 -549 -1068 -637 -103 -21 -142 -23 -370 -23 -240 1 -263 2 -385 28 -394 84 -694 250 -965 533 -424 444 -615 1022 -571 1734 11 196 27 306 66 461 91 360 256 662 505 923 302 316 681 505 1113 555 105 12 369 13 467 1z"></path>
              <path
                  d="M11815 8123 c-514 -44 -775 -93 -1120 -208 -422 -140 -773 -332 -1135 -619 -159 -126 -456 -424 -588 -588 -430 -539 -678 -1137 -784 -1888 -21 -152 -23 -199 -23 -605 0 -406 2 -453 23 -605 92 -655 280 -1164 613 -1655 226 -335 543 -664 878 -914 222 -165 504 -326 756 -430 55 -23 129 -55 165 -71 168 -74 568 -174 835 -209 44 -6 100 -13 125 -17 25 -3 56 -7 70 -9 92 -13 238 -20 450 -20 277 0 377 7 570 41 14 2 70 11 125 19 180 28 257 45 455 102 508 144 943 368 1355 697 133 107 440 413 553 554 452 559 707 1176 809 1957 15 117 18 211 18 565 -1 386 -3 440 -23 589 -107 771 -355 1364 -810 1931 -110 136 -416 439 -562 556 -604 481 -1262 737 -2094 814 -201 18 -526 25 -661 13z m635 -1818 c174 -36 312 -85 459 -161 159 -81 277 -166 414 -294 357 -337 572 -766 649 -1295 20 -139 17 -600 -6 -745 -88 -576 -360 -1043 -798 -1373 -240 -181 -533 -296 -858 -336 -109 -14 -371 -14 -480 -1 -214 27 -398 80 -580 166 -195 93 -345 199 -501 354 -342 340 -553 801 -600 1310 -15 165 -6 561 16 700 133 844 690 1482 1450 1661 170 40 267 49 495 44 183 -3 233 -7 340 -30z"></path>
              <path
                  d="M30305 8114 c-499 -47 -866 -140 -1256 -318 -806 -368 -1503 -1096 -1867 -1951 -144 -338 -235 -679 -294 -1105 -21 -152 -23 -200 -23 -615 0 -496 8 -591 76 -925 149 -724 468 -1321 978 -1830 550 -548 1205 -875 2025 -1010 173 -28 222 -35 346 -46 30 -2 75 -7 100 -9 253 -24 582 -20 845 10 33 4 76 9 95 11 19 2 46 6 60 8 14 3 41 8 60 10 19 3 46 8 60 11 14 2 41 7 60 10 593 98 1101 301 1545 618 236 169 497 397 692 607 265 286 287 338 185 439 -50 49 -1157 823 -1232 861 -91 47 -159 25 -246 -77 -171 -201 -302 -326 -481 -460 -563 -420 -1172 -576 -1753 -447 -505 112 -923 450 -1160 938 -96 198 -171 436 -171 549 -1 71 17 102 77 132 39 20 64 20 2624 25 2426 5 2587 6 2617 22 17 10 40 29 52 43 39 51 43 108 38 545 -4 436 -13 542 -68 869 -26 157 -96 438 -148 596 -143 441 -357 838 -647 1202 -106 133 -414 440 -549 547 -421 335 -899 557 -1440 670 -366 76 -846 104 -1200 70z m607 -1565 c612 -92 1066 -492 1273 -1124 55 -166 78 -282 73 -361 -4 -68 -19 -93 -73 -123 -27 -15 -159 -16 -1580 -16 -1421 0 -1553 1 -1580 16 -85 47 -94 112 -41 300 133 479 377 851 699 1066 203 135 481 228 757 253 114 10 371 5 472 -11z"></path>
              <path
                  d="M24615 7901 c-113 -8 -150 -27 -185 -96 l-25 -50 0 -3520 c0 -1936 4 -3542 8 -3568 10 -58 53 -110 105 -129 29 -10 219 -13 932 -13 l895 0 49 25 c36 18 56 36 70 65 l21 40 0 3560 0 3560 -21 40 c-15 28 -35 47 -70 65 l-48 25 -821 1 c-451 1 -860 -1 -910 -5z"></path>
            </g>
          </devs>
          <use xlink:href="#logosvg"></use>
        </svg>
      </div>
      <div class="item header">
        <h1>Your checkout</h1>
      </div>
    </div>
    <div class="grid-container second" v-for="(product, index) in this.$store.state.productsStore.cardProducts"
         :key="index">
      <div class="item image">
        <img :src="product.image">
        <div class="circle" v-text="product.quantity"></div>
      </div>
      <div class="item title" v-text="product.title"></div>
      <div class="item total">${{ product.total }}</div>
    </div>
    <div class="grid-container third">
      <div class="item subtotal-title">Subtotal</div>
      <div class="item subtotal-val" v-text="getTotalPrice"></div>
    </div>
    <form class="submit-box" @submit.prevent="submitHandler">
      <div class="header-box">
        <h2>Contact information</h2>
      </div>
      <div class="input-wrapper first-name">
        <input
            id="firstName"
            v-model="firstName"
            :class="{invalid: invalidFirst}"
        >
        <label data-first="Enter your first name" data-second="First name"></label>
        <small v-show="invalidFirst"> Enter your first name!</small>
      </div>
      <div class="input-wrapper last-name">
        <input
            id="lastName"
            v-model="lastName"
            :class="{invalid: invalidLast}"
        >
        <label data-first="Enter your last name" data-second="Last name"></label>
        <small v-show="invalidLast"> Enter your last name!</small>
      </div>
      <div class="input-wrapper phone">
        <input
            id="phone"
            v-model="phone"
            :class="{invalid: invalidPhone || !$v.phone.numeric || !$v.phone.minLength || !$v.phone.maxLength}"
        >
        <label data-first="Enter your phone" data-second="Phone"></label>
        <small v-show="invalidPhone"> Enter your phone!</small>
        <small v-show="!$v.phone.numeric"> Enter only numeric!</small>
        <small
            v-show="!$v.phone.minLength || !$v.phone.maxLength"
        >
          The length of the number should be {{ $v.phone.$params.maxLength.max }}. Now it {{phone.length}}!
        </small>
      </div>
      <div class="input-wrapper delivery">
        <select v-model="selected">
          <option disabled value="">Select delivery method</option>
          <option>Новая почта</option>
          <option>Другие</option>
        </select>
      </div>
      <div class="input-wrapper new-post-city" v-show="selected === 'Новая почта'">
        <input id="post-city">
        <label data-first="Enter city name" data-second="City name"></label>
      </div>
      <div class="input-wrapper new-post-office" v-show="selected === 'Новая почта'">
        <input id="post-office">
        <label data-first="Enter post address" data-second="Post address"></label>
      </div>
      <div class="input-wrapper others" v-show="selected === 'Другие'">
        <textarea
            id="others"
            v-model="address"
        ></textarea>
        <label data-first="Enter address" data-second="delivery address"></label>
      </div>
      <div class="input-wrapper button-block">
        <div class="return-to-card">
          <router-link :to="{name: 'Card'}" class="continue-shopping">Return to card</router-link>
        </div>
        <div class="continue-shipping">
          <button type="submit">Continue shipping</button>
        </div>
      </div>
    </form>
  </div>
</template>

<script>
import {mapGetters} from 'vuex';
import {required, numeric, minLength, maxLength} from 'vuelidate/lib/validators'

export default {
  name: "Checkout",
  computed: {
    ...mapGetters(["getTotalPrice"])
  },
  data() {
    return {
      selected: '',
      firstName: '',
      lastName: '',
      delivery: '',
      address: '',
      city: '',
      postOffice: '',
      phone: '',
      invalidFirst: false,
      invalidLast: false,
      invalidPhone: false
    }
  },
  validations: {
    firstName: {required},
    lastName: {required},
    phone: {required, numeric, minLength: minLength(10), maxLength: maxLength(10)}
  },
  methods: {
    submitHandler() {
      this.invalidFirst = !this.$v.firstName.required
      this.invalidLast = !this.$v.lastName.required
      this.invalidPhone = !this.$v.phone.required
      this.delivery = this.selected;
      if (this.$v.invalid) {
        this.$v.$touch()
        return
      }
    }
  }
}
</script>

<style scoped>
.wrapper {

}

.grid-container {
  display: grid;
  max-width: 1200px;
  grid-template-columns: 27% 58% 15%;
}

.first {
  margin: 0 auto;
}

.header {
  grid-column: 2/4;
  text-align: center;
}

.second {
  margin: 0 auto;
}

.third {
  margin: 15px auto;
}

.subtotal-title {
  grid-column: 1/3;
  color: rgb(48, 48, 48);
  font-weight: 600;
}

.subtotal-val {
  color: rgb(48, 48, 48);
  font-weight: 600;
  font-size: 24px;
}

.item {
  align-self: center;
}

.image {
  display: flex;
}

img {
  margin: 5%;
  width: 5vmax;
  border-radius: 5px;
}

.circle {
  width: 22px;
  height: 22px;
  background: green;
  -moz-border-radius: 50px;
  -webkit-border-radius: 50px;
  border-radius: 50px;
  align-self: flex-start;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  margin-bottom: 23%;
  margin-left: -15%;
  align-items: center;
  color: white;
  position: relative;
  font-size: 14px;
}

.title {
  margin-left: 5%;
  color: rgb(48, 48, 48);
  font-weight: 600;
}

.total {
  color: rgb(48, 48, 48);
  font-weight: 600;
}

h2 {
  grid-column: 1/4;
  align-self: center;
  display: flex;
  justify-content: flex-start;
  color: rgb(48, 48, 48);
  font-weight: 400;
}

.submit-box {
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  max-width: 1200px;
  margin: 0 auto;
}

.header-box {
  width: 100%;
}

.input-wrapper {
  height: 2.5vmax;
  position: relative;
  display: inline-block;
  verical-align: baseline;
  line-height: 14px;
}

#firstName,
#lastName,
#phone {
  text-align: center;
}

.first-name {
  flex-grow: 1;
}

.last-name {
  flex-grow: 1;
  margin-left: 2%;
}

.phone {
  width: 100%;
  margin-top: 3%;
  margin-bottom: 3%;
}

label {
  position: absolute;
  top: 34%;
  left: 5%;
  padding: 0 2px;
  color: #bbb;
  font-size: 11px;
  text-transform: uppercase;
  z-index: 2;
  pointer-events: none;
  background: #fff;
  transition: transform 200ms ease;
  transform: translateY(-20px);
}

label:before {
  content: attr(data-first);
  white-space: nowrap;
}

input {
  position: relative;
  width: 100%;
  height: 100%;
  font-size: 13px;
  color: #555;
  outline: none;
  border: 1px solid #bbb;
  border-radius: 5px;
}

input:invalid + label {
  transform: translateY(0);
}

input:focus + label {
  transform: translateY(-20px);
}

input:focus + label:before {
  content: attr(data-second);
  border-color: #2b96f1;
  color: #2b96f1;
}

input:required:invalid + label[data-first][data-second]:before {
  content: attr(data-first);
}

input:focus + label[data-first][data-second]:before {
  content: attr(data-second);
}

input:required + label[data-second]:before {
  content: attr(data-second);
}

.invalid {
  border-color: red;
}

.continue-shopping {
  justify-self: center;
  align-self: center;
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  align-items: center;
  width: 100%;
  height: 90%;
  border: 1px solid #e8e9eb;
  text-transform: uppercase;
  font-size: 14px;
  font-weight: 500;
  border-radius: 3px;
  text-decoration: none;
  color: #3d4246;
}

button {
  height: 93%;
  border: none;
  background-color: #2b8000;
  border-radius: 5px;
  color: white;
  width: 105%;
}

small {
  color: red;
  padding-left: 1%;
}

.delivery {
  width: 100%;
  height: 2.55vmax;
  margin-bottom: 3%;
}

select {
  height: 100%;
  width: 15%;
  border: 1px solid #bbb;
  border-radius: 5px;
  color: rgb(80, 80, 80);
  background-color: white;
  padding-left: 1%;
}

.new-post-city,
.new-post-office {
  flex-grow: 1;
}

.new-post-office {
  margin-left: 2%;
}

.button-block {
  width: 100%;
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  margin-top: 3%;
}

.others {
  width: 100%;
  margin-bottom: 3%;
}

textarea {
  width: 100%;
  height: 5vmax;
  border: 1px solid #bbb;
  border-radius: 5px;
  color: rgb(80, 80, 80);
}

textarea:invalid + label {
  transform: translateY(0);
}

textarea:focus + label {
  transform: translateY(-20px);
}

textarea:focus + label:before {
  content: attr(data-second);
  border-color: #2b96f1;
  color: #2b96f1;
}

textarea:required:invalid + label[data-first][data-second]:before {
  content: attr(data-first);
}

textarea:focus + label[data-first][data-second]:before {
  content: attr(data-second);
}

textarea:required + label[data-second]:before {
  content: attr(data-second);
}

</style>